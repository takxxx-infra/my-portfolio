---
type ProjectItem = {
	title: string;
	period: string;
	role?: string;
	summary: string;
	outcome: string;
	tech: string[];
	phases?: string[];
	techTable?: { label: string; values: string[] }[];
	github?: string | boolean;
	diagram?: string;
};

const { projects, viewMoreLink } = Astro.props as {
	projects: ProjectItem[];
	viewMoreLink?: string;
};
---

<section id="works" class="w-full py-12">
	<header class="space-y-2 text-center md:text-left">
		<p class="text-xs font-semibold uppercase tracking-[0.4em] text-[#7c94b1]">Experience</p>
		<h2 class="text-3xl font-black text-[#2e4666]">実務経験</h2>
	</header>
	<div class="mt-8 space-y-10">
		{projects.map((item) => (
			<article class="border-b border-[#dbe5f1] pb-12 last:border-0 last:pb-0">
				<div class="grid gap-6 md:grid-cols-2 md:gap-10">
					<div class="space-y-3 text-[#2e4666]">
						<p class="text-xs font-semibold uppercase tracking-[0.3em] text-[#879cb7]">{item.period}</p>
						<h3 class="text-2xl font-bold">{item.title}</h3>
						{item.role && <p class="text-sm font-semibold text-[#5f7693]">Role: {item.role}</p>}
						{item.phases?.length ? (
							<div class="flex flex-wrap gap-2 text-xs font-semibold text-[#3a5f88]">
								<p class="text-sm font-semibold text-[#5f7693]">担当工程:</p>
								{item.phases.map((phase) => (
									<span class="rounded-full border border-[#dbe5f1] px-3 py-0.5 text-[#2e4666]">{phase}</span>
								))}
							</div>
						) : null}
						<p class="whitespace-pre-line text-base leading-relaxed text-[#4f6d91]">{item.summary}</p>
						<p class="whitespace-pre-line text-sm font-semibold text-[#397bc2]">{item.outcome}</p>
					</div>
					<table class="h-fit w-full border border-[#dbe5f1] text-left text-sm text-[#2e4666]">
						<tbody>
							{(item.techTable ?? [{ label: "使用技術", values: item.tech }]).map((row) => (
								<tr class="border-b border-[#dbe5f1] last:border-0">
									<th class="w-32 bg-[#f5f8fc] px-4 py-3 font-semibold">{row.label}</th>
									<td class="px-4 py-3">{row.values.join(", ")}</td>
								</tr>
							))}
						</tbody>
					</table>
				</div>
			</article>
		))}
	</div>

	{viewMoreLink && (
		<div class="mt-10 text-center">
			<a
				class="inline-flex items-center rounded-full bg-[#397bc2] px-8 py-3 text-sm font-semibold text-white shadow-sm transition hover:-translate-y-0.5"
				href={viewMoreLink}
				style={{ color: '#fff' }}
			>
				View More
			</a>
		</div>
	)}
</section>
